---
milestone: v2.2
audited: 2026-02-27T10:15:00Z
status: passed
scores:
  requirements: 22/22
  phases: 5/5
  integration: Passed
  flows: Passed
gaps:
  requirements: []
  integration: []
  flows: []
tech_debt:
  - phase: 35-agent-demo-oauth
    items:
      - "Inconsistency: CLI command is 'configure' in agent-demo.py but 'config' in client-demo.py"
  - phase: 36-client-demo-core
    items:
      - "Manual step: User must manually map CLIENT_{uuid}_ID from agent-demo to CLIENT_ID in client-demo.py config"
  - phase: 37-client-demo-oauth
    items:
      - "Backend bug: Discovery URLs lack /v1/ prefix; scripts work around this by hardcoding endpoints"
  - milestone: v2.2
    items:
      - "Unresolved debug session: shadow-overseer-reuse.md (diagnosed, root cause in agents.ts /malice/:agentId)"
---

# Milestone v2.2 Audit Report: Demo Scripts

## Summary

Milestone v2.2 (Demo Scripts) has successfully achieved its definition of done. All 22 requirements across 5 phases are satisfied and verified. The Python demo scripts (`agent-demo.py` and `client-demo.py`) provide full coverage of the Agent-ID identity platform capabilities, including advanced features like DPoP, PKCE, and dual-signature key rotation.

## Requirements Coverage

| ID | Description | Phase | Status |
|----|-------------|-------|--------|
| ACONF-01 | Agent .env configuration | 33 | ✓ SATISFIED |
| ACONF-02 | Ed25519 key generation (agent) | 33 | ✓ SATISFIED |
| ACONF-03 | Public key validation | 33 | ✓ SATISFIED |
| AAUTH-01 | 2-step registration | 33 | ✓ SATISFIED |
| AAUTH-02 | DPoP login | 33 | ✓ SATISFIED |
| AAUTH-03 | Logout (session revocation) | 33 | ✓ SATISFIED |
| AAUTH-04 | Query /agents/me | 33 | ✓ SATISFIED |
| AAUTH-05 | Dual-signature key rotation | 34 | ✓ SATISFIED |
| AQUERY-01 | OAuth history query | 34 | ✓ SATISFIED |
| AQUERY-02 | Overseer info query | 34 | ✓ SATISFIED |
| ACLAIM-01 | Claim completion | 34 | ✓ SATISFIED |
| ACLAIM-02 | Overseer revocation | 34 | ✓ SATISFIED |
| AOAUTH-01 | Register OAuth client | 35 | ✓ SATISFIED |
| AOAUTH-02 | Initiate authorization | 35 | ✓ SATISFIED |
| CCONF-01 | Client .env configuration | 36 | ✓ SATISFIED |
| CCONF-02 | PKCE pair generation | 36 | ✓ SATISFIED |
| CCONF-03 | Ed25519 key generation (client) | 36 | ✓ SATISFIED |
| CTOKEN-01 | Token exchange (callback server) | 36 | ✓ SATISFIED |
| CTOKEN-02 | Token refresh | 37 | ✓ SATISFIED |
| CTOKEN-03 | Token revocation | 37 | ✓ SATISFIED |
| COAUTH-01 | Userinfo with DPoP | 37 | ✓ SATISFIED |
| COAUTH-02 | Token introspection | 37 | ✓ SATISFIED |
| COAUTH-03 | OpenID discovery | 37 | ✓ SATISFIED |

## Phase Status

| Phase | Goal | Status |
|-------|------|--------|
| 33 | Agent Demo Core | ✓ PASSED |
| 34 | Agent Demo Extended | ✓ PASSED |
| 35 | Agent Demo OAuth | ✓ PASSED |
| 36 | Client Demo Core | ✓ PASSED |
| 37 | Client Demo OAuth | ✓ PASSED |

## Integration & E2E Flows

The integration check verified that:
1. **Agent lifecycle** works from registration to key rotation and logout.
2. **OAuth flow** works across both scripts (registering in agent-demo, exchanging in client-demo).
3. **State persistence** in `.env` is consistent and reliable.
4. **Auth patterns** (Bearer, DPoP, private_key_jwt) are correctly implemented for each endpoint.

## Tech Debt & Gaps

1. **Command Naming**: `agent-demo.py` uses `configure` whereas `client-demo.py` uses `config`.
2. **Namespace Mapping**: The client ID saved by `agent-demo` (`CLIENT_{id}_ID`) is not automatically picked up by `client-demo` (which looks for `CLIENT_ID`).
3. **Backend Discovery URLs**: Discovery URLs in the `/v1/oauth/.well-known/openid-configuration` response are missing the `/v1` prefix. Scripts hardcode the correct endpoints as a workaround.
4. **Unresolved Bug**: The `shadow-overseer-reuse` bug (diagnosed in `shadow-overseer-reuse.md`) exists in the backend API but does not prevent the demo scripts from functioning correctly for standard flows.

## Conclusion

The milestone is complete. The demo scripts are substantive, well-structured, and provide clear examples for users to interact with the Agent-ID platform.

---
_Audit completed by Antigravity (OpenCode) on 2026-02-27_
