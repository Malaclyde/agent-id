---
phase: 08-api-prefix-to-v1-prefix
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - backend/src/index.ts
autonomous: true
user_setup: []

must_haves:
  truths:
    - "All API routes use /v1/* prefix"
    - "Webhooks route uses /v1/webhooks prefix"
    - "OAuth route uses /v1/oauth prefix"
  artifacts:
    - path: "backend/src/index.ts"
      provides: "Route registration with /v1 prefix"
      contains: "app.route('/v1/"
  key_links:
    - from: "backend/src/index.ts"
      to: "backend/src/routes/agents.ts"
      via: "app.route('/v1/agents', agents)"
    - from: "backend/src/index.ts"
      to: "backend/src/routes/overseers.ts"
      via: "app.route('/v1/overseers', overseers)"
    - from: "backend/src/index.ts"
      to: "backend/src/routes/clients.ts"
      via: "app.route('/v1/clients', clients)"
    - from: "backend/src/index.ts"
      to: "backend/src/routes/subscriptions.ts"
      via: "app.route('/v1/subscriptions', subscriptions)"
    - from: "backend/src/index.ts"
      to: "backend/src/routes/webhooks.ts"
      via: "app.route('/v1/webhooks', webhooks)"
    - from: "backend/src/index.ts"
      to: "backend/src/routes/oauth.ts"
      via: "app.route('/v1/oauth', oauth)"
---

<objective>
Migrate all backend API routes from /api/* and /webhooks and /oauth to /v1/* prefix.

Purpose: Align API structure with v1 versioning standard for better API organization and future compatibility.
Output: Updated backend/src/index.ts with all routes under /v1 prefix
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@backend/src/index.ts

Current routes:
- /api/agents -> migrate to /v1/agents
- /api/overseers -> migrate to /v1/overseers  
- /api/clients -> migrate to /v1/clients
- /api/subscriptions -> migrate to /v1/subscriptions
- /webhooks -> migrate to /v1/webhooks
- /oauth -> migrate to /v1/oauth
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate API routes to /v1 prefix</name>
  <files>backend/src/index.ts</files>
  <action>
    Update backend/src/index.ts to change all route registrations:

    Change:
    - app.route('/api/agents', agents) → app.route('/v1/agents', agents)
    - app.route('/api/overseers', overseers) → app.route('/v1/overseers', overseers)
    - app.route('/api/clients', clients) → app.route('/v1/clients', clients)
    - app.route('/api/subscriptions', subscriptions) → app.route('/v1/subscriptions', subscriptions)
    - app.route('/webhooks', webhooks) → app.route('/v1/webhooks', webhooks)
    - app.route('/oauth', oauth) → app.route('/v1/oauth', oauth)

    Also update the root endpoint response in index.ts to reflect new paths:
    - /api/agents → /v1/agents
    - /api/overseers → /v1/overseers
    - /api/clients → /v1/clients
    - /api/subscriptions → /v1/subscriptions
    - /webhooks → /v1/webhooks
    - /oauth → /v1/oauth
  </action>
  <verify>
    Verify all 6 route registrations use /v1/ prefix:
    grep -n "app.route" backend/src/index.ts
  </verify>
  <done>
    All route registrations use /v1/ prefix, root endpoint shows new paths
  </done>
</task>

</tasks>

<verification>
- Run: grep -n "app.route" backend/src/index.ts
- Verify all 6 routes use /v1/ prefix
- Verify root endpoint object shows new paths
</verification>

<success_criteria>
All 6 routes migrated: /v1/agents, /v1/overseers, /v1/clients, /v1/subscriptions, /v1/webhooks, /v1/oauth
</success_criteria>

<output>
After completion, create `.planning/phases/08-api-prefix-to-v1-prefix/08-01-SUMMARY.md`
</output>
