---
phase: 25-frontend-update
plan: 01
type: execute
wave: 1
depends_on: [24-01]
files_modified:
  - frontend/src/api/client.ts
autonomous: true

must_haves:
  truths:
    - API client exports updated shadow claim methods
    - TypeScript types defined for shadow claim flow
    - Methods handle errors correctly
  artifacts:
    - path: frontend/src/api/client.ts
      provides: Shadow claim API methods
      contains: "initiateShadowClaim|getChallengeStatus"
  key_links:
    - from: initiateShadowClaim
      to: POST /v1/agents/malice/:agentId
      via: fetch API
      pattern: "POST.*agents/malice"
    - from: getChallengeStatus
      to: GET /v1/agents/malice/status/:challengeId
      via: fetch API
      pattern: "GET.*agents/malice/status"
---

<objective>
Update API client with shadow claim endpoints and types.

Purpose: Provide foundation for shadow claim flow with proper type definitions
Output: Updated API client with initiateShadowClaim and getChallengeStatus methods
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md

@frontend/src/api/client.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update API client methods</name>
  <files>frontend/src/api/client.ts</files>
  <action>
    Update API client for new endpoints:
    
    1. Update initiateShadowClaim(agentId):
       - Endpoint: POST /v1/agents/malice/{agentId}
       - Response: { success, challenge_id, shadow_id, expires_at }
       - Returns challenge_id (not payment_challenge_id)
    
    2. Update getChallengeStatus(challengeId):
       - Endpoint: GET /v1/agents/malice/status/{challengeId}
       - Response: { status, agent_id, shadow_overseer_id, expires_at }
       - Status values: 'initiated', 'awaiting-payment', 'completed', 'expired'
    
    3. Add or update types:
       ```typescript
       type ShadowClaimStatus = 'initiated' | 'awaiting-payment' | 'completed' | 'expired';
       
       interface ShadowClaimResponse {
         success: boolean;
         challenge_id: string;
         shadow_id: string;
         expires_at: string;
       }
       
       interface ChallengeStatusResponse {
         status: ShadowClaimStatus;
         agent_id: string;
         shadow_overseer_id: string;
         expires_at: string;
       }
       ```
    
    4. Remove old payment challenge methods if they exist
    
    5. Ensure all methods handle errors correctly
  </action>
  <verify>
    - API client compiles without errors
    - All methods updated correctly
    - TypeScript types defined
    - Error handling works
  </verify>
  <done>
    API client updated with new endpoints and types
  </done>
</task>

</tasks>

<verification>
1. Frontend compiles without TypeScript errors
2. API client exports initiateShadowClaim and getChallengeStatus
3. Types are properly exported
4. Error handling implemented
</verification>

<success_criteria>
- API client provides shadow claim methods with correct endpoints
- TypeScript types defined for request/response
- Methods handle network and API errors
- Old payment challenge methods removed
</success_criteria>

<output>
After completion, create `.planning/phases/25-frontend-update/25-01-SUMMARY.md`
</output>
