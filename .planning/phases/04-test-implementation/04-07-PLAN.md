---
phase: 04-test-implementation
plan: 07
type: execute
wave: 3
depends_on: ["01", "02", "04", "06"]
files_modified:
  - test/coverage/backend-coverage.md
  - test/coverage/frontend-coverage.md
  - test/coverage/test-scenarios-matrix.md
autonomous: true

must_haves:
  truths:
    - "All documented test scenarios have corresponding implemented tests"
    - "Coverage reports exist for backend and frontend"
    - "Test documentation explains how to run tests and interpret results"
    - ">80% coverage target is met for backend and frontend"
  artifacts:
    - path: "test/coverage/backend-coverage.md"
      provides: "Backend coverage report and analysis"
      min_lines: 50
    - path: "test/coverage/frontend-coverage.md"
      provides: "Frontend coverage report and analysis"
      min_lines: 50
    - path: "test/coverage/test-scenarios-matrix.md"
      provides: "Cross-reference of test scenarios to implemented tests"
      min_lines: 80
  key_links:
    - from: "test/coverage/"
      to: "docs/v1/test scenarios/*.md"
      via: "Test scenario matrix"
      pattern: "TS-.*"
---

<objective>
Verify coverage targets are met and cross-reference implemented tests with documented test scenarios.

Purpose: Ensure all test scenarios from Phase 2 have corresponding tests, document coverage, and provide test running instructions.
Output: Coverage documentation in test/coverage/
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@docs/v1/test scenarios/registration.md
@docs/v1/test scenarios/claim.md
@docs/v1/test scenarios/client.md
@docs/v1/test scenarios/subscription.md
@docs/v1/test scenarios/edge-cases.md
@docs/v1/test scenarios/error-handling.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Generate and document backend coverage</name>
  <files>test/coverage/backend-coverage.md</files>
  <action>
    Create test/coverage/ directory and backend-coverage.md.
    
    Run coverage analysis:
    - `cd backend && npm run test -- --coverage`
    - Document overall coverage percentage
    - List services with >80% coverage
    - Identify services below target
    - Document critical path coverage (auth, subscription, OAuth)
    
    Include instructions for running backend tests.
  </action>
  <verify>Backend coverage >80% target met</verify>
  <done>Backend coverage is documented</done>
</task>

<task type="auto">
  <name>Task 2: Generate and document frontend coverage</name>
  <files>test/coverage/frontend-coverage.md</files>
  <action>
    Create frontend-coverage.md.
    
    Run coverage analysis:
    - Configure vitest coverage for frontend unit tests
    - Document overall coverage percentage
    - List components with tests
    - Identify components without tests
    
    Include instructions for running frontend tests.
  </action>
  <verify>Frontend coverage has meaningful test coverage on critical paths</verify>
  <done>Frontend coverage is documented</done>
</task>

<task type="auto">
  <name>Task 3: Create test scenarios matrix</name>
  <files>test/coverage/test-scenarios-matrix.md</files>
  <action>
    Create test-scenarios-matrix.md file.
    
    Cross-reference each test scenario from docs/v1/test scenarios/:
    - TS-R001 (Overseer Registration): backend/test/unit/auth.test.ts, test/e2e/registration-flow.spec.ts
    - TS-R002 (Duplicate Email): backend/test/unit/auth.test.ts
    - TS-C001 (Agent Claim): backend/test/unit/ownership.test.ts, test/e2e/registration-flow.spec.ts
    - TS-CL001 (Client Registration): backend/test/unit/client-limits.test.ts, test/e2e/oauth-flow.spec.ts
    - TS-S001 (Subscription Checkout): frontend/test/integration/paddle-checkout.test.ts, test/e2e/subscription-flow.spec.ts
    - etc.
    
    Mark each scenario as: Implemented | Partially Implemented | Not Implemented
    Document any gaps or missing test coverage
  </action>
  <verify>All documented test scenarios have corresponding tests</verify>
  <done>Test scenarios matrix is complete</done>
</task>

<task type="auto">
  <name>Task 4: Create test documentation README</name>
  <files>test/README.md</files>
  <action>
    Create comprehensive test README in test/ directory.
    
    Include:
    - How to run backend tests: `cd backend && npm test`
    - How to run frontend unit tests: `cd frontend && npm run test:unit`
    - How to run frontend integration tests: `cd frontend && npm run test:integration`
    - How to run E2E tests: `npx playwright test test/e2e/`
    - Prerequisites for each test type
    - Environment variables needed
    - Coverage targets and how to check
    - Troubleshooting tips
  </action>
  <verify>Test README is complete and accurate</verify>
  <done>Test documentation is comprehensive</done>
</task>

</tasks>

<verification>
Verify:
- Backend coverage >80%
- All test scenarios have corresponding tests
- Test documentation is complete
</verification>

<success_criteria>
All documented test scenarios from Phase 2 have corresponding implemented tests, >80% coverage achieved, and test documentation is complete
</success_criteria>

<output>
After completion, create `.planning/phases/04-test-implementation/04-07-SUMMARY.md`
</output>
