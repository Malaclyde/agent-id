---
phase: 04-test-implementation
plan: 04
type: execute
wave: 2
depends_on: []
files_modified:
  - frontend/test/unit/auth-context.test.tsx
  - frontend/test/unit/components/header.test.tsx
  - frontend/test/unit/pages/home.test.tsx
  - frontend/test/unit/api/client.test.ts
autonomous: true

must_haves:
  truths:
    - "Frontend unit tests exist for React components"
    - "AuthContext provider is tested"
    - "Header component is tested"
    - "Home page component is tested"
    - "API client functions are tested"
  artifacts:
    - path: "frontend/test/unit/auth-context.test.tsx"
      provides: "Unit tests for AuthContext provider"
      min_lines: 80
    - path: "frontend/test/unit/components/header.test.tsx"
      provides: "Unit tests for Header component"
      min_lines: 60
    - path: "frontend/test/unit/pages/home.test.tsx"
      provides: "Unit tests for Home page"
      min_lines: 60
    - path: "frontend/test/unit/api/client.test.ts"
      provides: "Unit tests for API client"
      min_lines: 60
  key_links:
    - from: "frontend/test/unit/"
      to: "frontend/src/components/*.tsx"
      via: "vitest + React Testing Library"
      pattern: "render|fireEvent"
    - from: "frontend/test/unit/"
      to: "frontend/src/context/*.tsx"
      via: "vitest + React Testing Library"
      pattern: "render|fireEvent"
---

<objective>
Write unit tests for frontend React components and context.

Purpose: Ensure frontend components render correctly and handle user interactions properly.
Output: Unit test files in frontend/test/unit/
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@frontend/src/components/Header.tsx
@frontend/src/context/AuthContext.tsx
@frontend/src/pages/Home.tsx
@frontend/src/api/client.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Set up frontend unit test infrastructure</name>
  <files>frontend/test/unit/vitest.config.ts</files>
  <action>
    Create frontend/test/unit/ directory and set up vitest configuration.
    Install @testing-library/react, @testing-library/jest-dom, jsdom if needed.
    Configure vitest for React testing with jsdom.
    Create test setup file with common mocks (localStorage, sessionStorage).
  </action>
  <verify>Run `cd frontend && npm run test:unit` (add this script) - vitest runs</verify>
  <done>Frontend unit test infrastructure is set up</done>
</task>

<task type="auto">
  <name>Task 2: Create AuthContext unit tests</name>
  <files>frontend/test/unit/auth-context.test.tsx</files>
  <action>
    Create auth-context.test.tsx file.
    Write unit tests for:
    - AuthContext provides correct initial state (not authenticated)
    - login: updates state, stores token
    - logout: clears state and tokens
    - isAuthenticated: returns correct value based on state
    - user: returns current user data
    
    Mock the API client.
    Use React Testing Library's render and act.
    Test loading states and error handling.
  </action>
  <verify>Run `cd frontend && npm run test:unit` - AuthContext tests pass</verify>
  <done>AuthContext provider is fully tested</done>
</task>

<task type="auto">
  <name>Task 3: Create component and page unit tests</name>
  <files>
    frontend/test/unit/components/header.test.tsx
    frontend/test/unit/pages/home.test.tsx
    frontend/test/unit/api/client.test.ts
  </files>
  <action>
    Create header.test.tsx:
    - Renders logo and navigation
    - Shows login/register when not authenticated
    - Shows user menu when authenticated
    - Logout button calls auth logout
    
    Create home.test.tsx:
    - Renders welcome message
    - Shows subscription status
    - Navigation buttons work
    
    Create api/client.test.ts:
    - get method makes correct fetch call
    - post method sends correct data
    - Error handling works
    - Auth header is included
  </action>
  <verify>Run `cd frontend && npm run test:unit` - all frontend tests pass</verify>
  <done>Frontend components and API client are tested</done>
</task>

</tasks>

<verification>
Run `cd frontend && npm run test:unit` and verify:
- All React component tests pass
- API client tests pass
- Critical path coverage achieved
</verification>

<success_criteria>
Frontend unit tests exist for React components with critical path coverage
</success_criteria>

<output>
After completion, create `.planning/phases/04-test-implementation/04-04-SUMMARY.md`
</output>
