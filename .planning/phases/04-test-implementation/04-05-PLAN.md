---
phase: 04-test-implementation
plan: 05
type: execute
wave: 2
depends_on: []
files_modified:
  - frontend/test/integration/paddle-checkout.test.ts
  - frontend/test/integration/subscription-management.test.ts
autonomous: true

must_haves:
  truths:
    - "Frontend integration tests verify Paddle.js integration"
    - "Checkout flow works in sandbox mode"
    - "Subscription management page works correctly"
    - "Paddle mock is used for unit/integration tests per decision"
  artifacts:
    - path: "frontend/test/integration/paddle-checkout.test.ts"
      provides: "Integration tests for Paddle checkout flow"
      min_lines: 100
    - path: "frontend/test/integration/subscription-management.test.ts"
      provides: "Integration tests for subscription management"
      min_lines: 80
  key_links:
    - from: "frontend/test/integration/"
      to: "frontend/src/pages/SubscriptionManagement.tsx"
      via: "Playwright + Paddle mock"
      pattern: "page.goto|expect"
---

<objective>
Write frontend integration tests for Paddle sandbox interactions.

Purpose: Verify frontend Paddle.js integration works correctly using mocks (per user decision).
Output: Integration test files in frontend/test/integration/
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@frontend/test/integration/subscription-tests.spec.js
@frontend/test/integration/utils/paddle-mock.js
@frontend/src/pages/SubscriptionManagement.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Expand Paddle checkout integration tests</name>
  <files>frontend/test/integration/paddle-checkout.test.ts</files>
  <action>
    Create TypeScript Playwright test file for Paddle checkout.
    
    Per user decision: Unit & Integration tests mock Paddle entirely (no real API calls).
    
    Write tests using existing paddle-mock.js:
    - Checkout opens with correct price ID for each tier
    - Custom data (overseer_id) is passed correctly
    - Success callback triggers correct navigation
    - Cancel callback triggers correct navigation
    - Error handling displays appropriate message
    
    Use the injectPaddleMockBeforeLoad() pattern from existing tests.
    Test for BASIC, PRO, PREMIUM tier checkouts.
  </action>
  <verify>Run `cd frontend && npm run test:integration` - Paddle checkout tests pass</verify>
  <done>Paddle checkout flow is tested with mocks</done>
</task>

<task type="auto">
  <name>Task 2: Expand subscription management integration tests</name>
  <files>frontend/test/integration/subscription-management.test.ts</files>
  <action>
    Create subscription-management.test.ts file.
    
    Write tests for:
    - SubscriptionManagement page loads for FREE tier (no upgrade needed)
    - SubscriptionManagement shows upgrade buttons for FREE tier
    - Current subscription details display correctly
    - Usage statistics display (agents, requests, registrations)
    - Upgrade modal opens with correct tier options
    - Cancel subscription flow works
    
    Mock /api/subscriptions/me endpoint responses.
    Test with different subscription tiers (FREE, BASIC, PRO).
  </action>
  <verify>Run `cd frontend && npm run test:integration` - subscription management tests pass</verify>
  <done>Subscription management page is fully tested</done>
</task>

</tasks>

<verification>
Run `cd frontend && npm run test:integration` and verify:
- All Paddle integration tests pass
- Subscription management tests pass
- Tests use mocks as per user decision
</verification>

<success_criteria>
Frontend integration tests verify Paddle.js integration in sandbox mode (mocked)
</success_criteria>

<output>
After completion, create `.planning/phases/04-test-implementation/04-05-SUMMARY.md`
</output>
