---
phase: 15-subscription-frontend-cosmetics
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/pages/SubscriptionManagement.tsx
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Free tier users see no error messages on subscription page"
    - "All usage progress bars use consistent darker color scheme"
    - "Free tier agents indicator shows striped progress bar (not 0/0 text)"
    - "OAuth usage section hidden FREE tier users"
    - "Upgrade tier cards have sharp for square borders (0px radius)"
    - "FREE tier uses distinct color (not grey)"
    - "Current subscription tier uses same color as upgrade cards"
  artifacts:
    - path: "frontend/src/pages/SubscriptionManagement.tsx"
      provides: "Subscription management UI with cosmetic refinements"
      contains: [
        "getTierColor FREE color changed",
        "error messages conditional on tier !== 'FREE'",
        "progress bars use consistent darker colors",
        "OAuth section hidden for FREE tier",
        "tier-card has border-radius: 0",
        "CurrentSubscriptionCard uses tier colors"
      ]
  key_links:
    - from: "CurrentSubscriptionCard"
      to: "getTierColor"
      via: "function call"
      pattern: "tierColor = getTierColor"
---

<objective>
Apply cosmetic refinements to the SubscriptionManagement.tsx component per user decisions in CONTEXT.md.

Purpose: Improve visual appearance without changing functionality
Output: Updated SubscriptionManagement.tsx with consistent styling
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@./.planning/phases/15-subscription-frontend-cosmetics/15-CONTEXT.md
@./.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update FREE tier color (not grey)</name>
  <files>frontend/src/pages/SubscriptionManagement.tsx</files>
  <action>
In the `getTierColor` function (around line 418-428), change the FREE tier color from grey to a distinct color. Per CONTEXT.md: "Choose a new color (NOT grey) - any distinct color from palette".

Use teal/cyan: FREE: { from: '#14b8a6', to: '#0d9488' } (distinct from blue/purple/amber, fits a "free" tier that stands out)

This color will be used by both the current subscription display and upgrade cards.
  </action>
  <verify>
Verify the getTierColor function returns new teal color for FREE tier
  </verify>
  <done>
FREE tier displays with teal color (#14b8a6 → #0d9488) instead of grey
</done>
</task>

<task type="auto">
  <name>Task 2: Remove error messages for FREE tier users</name>
  <files>frontend/src/pages/SubscriptionManagement.tsx</files>
  <action>
In `CurrentSubscriptionCard` component (lines 199-209), modify the error message rendering logic to only show expired/grace period errors for PAID tiers, not FREE tier.

Change:
```tsx
{isExpired ? (
  <div className="alert alert-error">
    Your subscription has expired...
  </div>
) : inGracePeriod ? (
  <div className="alert alert-error">
    Your subscription has expired but you are in a grace period...
  </div>
) : null}
```

To:
```tsx
{subscription.tier !== 'FREE' && isExpired ? (
  <div className="alert alert-error">
    Your subscription has expired. Please upgrade to continue using the service.
  </div>
) : subscription.tier !== 'FREE' && inGracePeriod ? (
  <div className="alert alert-error">
    Your subscription has expired but you are in a grace period until{' '}
    {new Date(subscription.grace_period_end!).toLocaleDateString()}.
    Please upgrade to maintain service.
  </div>
) : null}
```

This ensures FREE tier users see no error states - just a clean interface.
  </action>
  <verify>
Verify FREE tier users see no error messages, only the tier badge and usage stats
  </verify>
  <done>
FREE tier users see clean interface without "subscription expired" error messages
</done>
</task>

<task type="auto">
  <name>Task 3: Consistent progress bar colors (darker scheme)</name>
  <files>frontend/src/pages/SubscriptionManagement.tsx</files>
  <action>
In `getProgressColor` function (lines 173-178), change the color scheme to use darker colors consistent with the unlimited/striped pattern. Currently uses `var(--success)`, `var(--error)`, `var(--warning)`.

Per CONTEXT.md: "Use the darker color from the existing unlimited/striped progress bar pattern" and "Match the styling used for unlimited (striped) bars - use that darker color for all progress indicators"

The unlimited pattern uses `var(--primary)` as backgroundColor. Let's use a consistent darker palette:
- Normal (0-69%): Use darker green (#059669 - from tier colors "to")
- Warning (70-89%): Use darker amber (#d97706 - from PREMIUM "to")
- Error (90-100%): Use darker red (#dc2626)

Replace the function:
```tsx
const getProgressColor = (percentage: number, isUnlimited: boolean) => {
  if (isUnlimited) return 'var(--primary)';
  if (percentage >= 90) return '#dc2626';  // darker red
  if (percentage >= 70) return '#d97706';  // darker amber
  return '#059669';  // darker green
};
```

This ensures all progress bars use the same darker color scheme regardless of tier.
  </action>
  <verify>
Verify all progress bars (agents, clients, oauth) use consistent darker colors matching the tier "to" colors
  </verify>
  <done>
All usage progress bars use consistent darker color scheme (#059669, #d97706, #dc2626)
</done>
</task>

<task type="auto">
  <name>Task 4: FREE tier agents indicator as striped progress bar</name>
  <files>frontend/src/pages/SubscriptionManagement.tsx</files>
  <action>
In `CurrentSubscriptionCard`, modify how agents usage is displayed for FREE tier. Currently FREE tier shows "0/0" (lines 169, 226).

Per CONTEXT.md: "When on FREE tier, show 0/0 agents using the same striped progress bar pattern as unlimited tiers - Do NOT show '0/0' as a static number - use visual progress bar"

The `formatLimit` function (lines 163-167) returns display as "0/0" for FREE tier. Modify to return the striped pattern representation:

```tsx
const formatLimit = (limit: number, used: number, tier?: string) => {
  if (limit === -1) return { display: `${used}/∞`, percentage: 0, isUnlimited: true };
  // For FREE tier (limit === 0), show as unlimited/striped
  if (limit === 0 && tier === 'FREE') return { display: `${used}/∞`, percentage: 0, isUnlimited: true };
  const percentage = Math.min((used / limit) * 100, 100);
  return { display: `${used}/${limit}`, percentage, isUnlimited: false };
};
```

Then update the agentsUsage call to pass tier:
```tsx
const agentsUsage = formatLimit(subscription.max_agents, usage?.agents_claimed || 0, subscription.tier);
```

This makes FREE tier agents show as striped progress bar (like unlimited), not static "0/0".
  </action>
  <verify>
Verify FREE tier agents section shows striped progress bar, not "0/0" text
  </done>
  <done>
FREE tier agents indicator displays striped progress bar instead of "0/0" static text
</done>
</task>

<task type="auto">
  <name>Task 5: Hide OAuth usage for FREE tier</name>
  <files>frontend/src/pages/SubscriptionManagement.tsx</files>
  <action>
In `CurrentSubscriptionCard`, wrap the OAuth usage section (lines 252-263) to only display for paid tiers.

Per CONTEXT.md: "Hide OAuth requests information for FREE tier users - Only display OAuth usage for BASIC, PRO, PREMIUM, and other paid tiers"

Add conditional rendering:
```tsx
{subscription.tier !== 'FREE' && (
  <div className="usage-item">
    <div className="usage-label">
      <span>OAuth Requests (This Period)</span>
      <span className="usage-value">{oauthUsage.display}</span>
    </div>
    <div className="progress-bar">
      <div
        className="progress-fill"
        style={getProgressBarStyle(oauthUsage)}
      />
    </div>
  </div>
)}
```

This hides the OAuth row entirely for FREE tier users.
  </action>
  <verify>
Verify OAuth section is hidden for FREE tier, visible for all paid tiers
  </verify>
  <done>
OAuth usage section hidden for FREE tier users, visible for BASIC/PRO/PREMIUM
</done>
</task>

<task type="auto">
  <name>Task 6: Sharp square borders on upgrade tier cards</name>
  <files>frontend/src/pages/SubscriptionManagement.tsx</files>
  <action>
In `UpgradeOptionsCard`, modify the tier-card styling (lines 377-383) to use sharp square borders (0px border-radius).

Per CONTEXT.md: "Change border-radius from rounded to sharp square borders (0px radius) - This applies to tier cards in upgrade options section"

Add borderRadius: 0 to the tier-card style:
```tsx
<div
  key={tier.tier}
  className={`tier-card ${isMostPopular ? 'tier-card-popular' : ''}`}
  style={{
    borderTop: `4px solid ${colors.to}`,
    borderRadius: 0  // Sharp square borders per user decision
  }}
>
```

Also check if tier-card class in CSS has border-radius that needs overriding. If so, use inline style with `borderRadius: 0` to override.
  </action>
  <verify>
Verify tier cards in upgrade section have 0px border-radius (sharp square corners)
  </verify>
  <done>
Upgrade tier cards display with sharp square borders (no rounded corners)
</done>
</task>

<task type="auto">
  <name>Task 7: Consistent tier colors across page</name>
  <files>frontend/src/pages/SubscriptionManagement.tsx</files>
  <action>
In `CurrentSubscriptionCard`, ensure the tier badge uses the same colors as the upgrade cards.

The current implementation (lines 211-220) already uses `getTierColor(subscription.tier)` which now returns the consistent colors after Task 1. 

Verify the gradient is applied correctly:
```tsx
<div
  className="tier-badge-large"
  style={{
    background: `linear-gradient(135deg, ${tierColor.from}, ${tierColor.to})`,
    border: `3px solid ${tierColor.to}`
  }}
>
```

Since getTierColor now returns the same color scheme as upgrade cards (FREE: teal, BASIC: blue, PRO: purple, PREMIUM: amber), the current subscription will automatically match.

No code changes needed - this works because both components call getTierColor with the same tier string.
  </action>
  <verify>
Verify current subscription tier badge uses same colors as upgrade card for that tier
  </verify>
  <done>
Current subscription tier badge matches upgrade card colors for same tier
</done>
</task>

</tasks>

<verification>
1. FREE tier shows teal color, no error messages, striped agents bar, no OAuth section
2. All tiers show consistent darker progress bar colors
3. Upgrade cards have sharp square borders
4. Current subscription and upgrade cards use matching tier colors
</verification>

<success_criteria>
- All 7 cosmetic refinements implemented per CONTEXT.md decisions
- No functional changes - purely visual/cosmetic
- Build succeeds with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/15-subscription-frontend-cosmetics/15-01-SUMMARY.md`
</output>
