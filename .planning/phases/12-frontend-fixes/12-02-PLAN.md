---
phase: 12-frontend-fixes
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/pages/SubscriptionManagement.tsx
autonomous: true

must_haves:
  truths:
    - "Tier comparison table is removed from subscription management page"
    - "Cancel Subscription button is visible for paid tiers"
  artifacts:
    - path: "frontend/src/pages/SubscriptionManagement.tsx"
      provides: "Subscription page without tier comparison, with cancel option"
      contains: "Cancel Subscription"
  key_links:
    - from: "frontend/src/pages/SubscriptionManagement.tsx"
      to: "CurrentSubscriptionCard"
      via: "component render"
      pattern: "TierComparisonCard.*removed"
---

<objective>
Remove the tier comparison table from the subscription page and add UI for subscription cancellation (button that will call backend).

Purpose: Per user decision - keep current subscription display only, add ability to cancel/downgrade.
Output: Modified SubscriptionManagement.tsx
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-frontend-fixes/12-CONTEXT.md
@.planning/phases/12-frontend-fixes/12-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Remove tier comparison table from subscription page</name>
  <files>frontend/src/pages/SubscriptionManagement.tsx</files>
  <action>
1. Find the TierComparisonCard component rendering at line 539
2. Remove the line: `<TierComparisonCard tiers={tiers} currentTier={subscription?.tier || 'FREE'} />`
3. Keep CurrentSubscriptionCard and UpgradeOptionsCard components
4. Verify the TierComparisonCard component definition (lines 214-287) can be removed or kept (doesn't hurt to keep unused code)

This implements the locked decision: "REMOVE the tier comparison table from subscription pane, Keep the current subscription display only"
  </action>
  <verify>
Run `npm run build` in frontend directory to verify TypeScript compilation succeeds
  </verify>
  <done>
The subscription management page no longer displays the tier comparison table. Only the current subscription card and upgrade options are visible.
  </done>
</task>

<task type="auto">
  <name>Add Cancel Subscription button to current subscription card</name>
  <files>frontend/src/pages/SubscriptionManagement.tsx</files>
  <action>
1. Add state for showing cancel confirmation modal:
   - Add `const [showCancelModal, setShowCancelModal] = useState(false);` after existing state declarations
   
2. Add Cancel Subscription button in CurrentSubscriptionCard component (after the usage stats, before closing </div>):
   - Only show for non-FREE tiers with active subscription
   - Add conditional rendering:
   ```tsx
   {subscription && subscription.tier !== 'FREE' && subscription.is_active && (
     <button 
       className="btn btn-danger" 
       style={{ marginTop: '1rem' }}
       onClick={() => setShowCancelModal(true)}
     >
       Cancel Subscription
     </button>
   )}
   ```

3. Add CancelConfirmationModal component or inline modal after UpgradeModal:
   - Show warning: "Your subscription will remain active until [billing_period_end]"
   - Confirm button calls API to cancel
   - Cancel button closes modal

4. Add API call function to handle cancellation (will be wired to backend endpoint in plan 12-04):
   - The cancel API call will be: `api.cancelSubscription()` - add to api/client.ts in plan 12-04
   - For now, just add the UI and make the button show an alert: "Cancellation will be available after backend endpoint is implemented"

This implements: "ADD Cancel Subscription / Downgrade to FREE option"
  </action>
  <verify>
Run `npm run build` in frontend directory to verify TypeScript compilation succeeds
  </verify>
  <done>
Cancel Subscription button appears for users with BASIC/PRO/PREMIUM tiers. Clicking shows a confirmation modal (placeholder for now).
  </done>
</task>

</tasks>

<verification>
1. Navigate to Subscription Management page
2. Verify tier comparison table is NOT displayed
3. For users with BASIC/PRO/PREMIUM subscription, verify Cancel Subscription button is visible
4. Click Cancel Subscription - verify modal appears with confirmation message
</verification>

<success_criteria>
- [ ] Tier comparison table removed from page
- [ ] Cancel Subscription button visible for paid tiers
- [ ] Confirmation modal appears on click
- [ ] TypeScript builds without errors
</success_criteria>

<output>
After completion, create `.planning/phases/12-frontend-fixes/12-02-SUMMARY.md`
</output>
